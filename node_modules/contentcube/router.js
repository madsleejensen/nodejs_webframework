var url = require("url");
var utils = require("./utils");

var defaultControllerName = "index";
var defaultActionName = "indexAction";

exports.route = function(request, callback)
{	
	var parts = url.parse(request.url);
	var uri = utils.trim(parts.pathname, '/');
	
	var segments = [];
		
	if (uri.length != 0) {
		segments = uri.indexOf("/") != -1 ? uri.split('/') : [uri];
	}
		
	var controllerName = defaultControllerName;
	var actionName = defaultActionName;

	if (segments.length > 0) {
		controllerName = segments.shift();
	}

	if (segments.length > 0) {
		actionName = segments.shift() + "Action";
	}
	
	if (segments.length > 0) {
		request.setParams(segments);
	}
	
	request.controllerName = controllerName;
	request.actionName = actionName;

	callback();
}